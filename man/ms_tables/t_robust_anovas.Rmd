---
output:  
  word_document:
    reference_docx: "../../man/template_tables_portrait.docx"
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE, echo=FALSE}
library(tidyverse)
library(here)
library(pander)
library(kableExtra)
library(knitr)
library(dplyr)
```


**Table 3.** Robust two-way ANOVAs of the resilience metrics of greenness (EVI) and tree-growth (BAI) for the factor drought events (2005 and 2012) and site. 

```{r, echo=FALSE, include = FALSE}
### Table R1_evi
evi <- read.csv(here("/out/anovas_resilience/huber_evi", "trimmed_anovas.csv"), header = TRUE)
names(evi) <- c('factores', 'F', 'p', 'variables')

dff_evi <- evi %>% gather(temp, numeros, F, p) %>% 
  unite(temp1, variables, temp) %>% 
  spread(temp1, numeros) %>% 
  mutate(factores = recode(factores, 
                           "disturb_year" = "Drougth event", 
                           "disturb_year:site" = "Drougth event X Site", 
                           "site" = "Site")) %>% 
  arrange(match(factores, c("Drougth event", "Site", "Drougth event X Site"))) %>% 
  mutate_at(c(2,4,6,8), round, 2) %>% 
  mutate_at(c(3,5,7,9), round, 3) %>% 
  mutate(variable = 'evi')


bai <- read.csv(here("/out/anovas_resilience/huber_bai", "trimmed_anovas.csv"), header = TRUE)
names(bai) <- c('factores', 'F', 'p', 'variables')

dff_bai <- bai %>% gather(temp, numeros, F, p) %>% 
  unite(temp1, variables, temp) %>% 
  spread(temp1, numeros) %>% 
  mutate(factores = recode(factores, 
                           "disturb_year" = "Drougth event", 
                           "disturb_year:site" = "Drougth event X Site", 
                           "site" = "Site")) %>% 
  arrange(match(factores, c("Drougth event", "Site", "Drougth event X Site"))) %>% 
  mutate_at(c(2,4,6,8), round, 2) %>% 
  mutate_at(c(3,5,7,9), round, 3) %>% 
  mutate(variable = 'bai')

dff <- dff_evi %>% 
  bind_rows(dff_bai) %>% 
  dplyr::select(-rrs_F, -rrs_p) %>% 
  dplyr::select(variable, factores, rt_F, rt_p, rc_F, rc_p, rs_F, rs_p)
```


```{r, echo=FALSE}
colnames(dff) <- c("variable", "factores", "rt\nF", "rt\np", "rc\nF", "rc\np", "rs\nF", "rs\np")
pander(dff)
```

