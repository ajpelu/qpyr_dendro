---
title: "dendro"
author: "AJ Perez-Luque (@ajpelu)"
date: "2017 Feb"
output:  
  md_document:
    variant: markdown_github
---

```{r, warning=FALSE, message=FALSE}}
library("tidyverse")
library("dplR")
```


# Read data 
```{r, echo=FALSE}
machine <- 'ajpelu'
# machine <- 'ajpeluLap'
di <- paste('/Users/', machine, '/Dropbox/phd/phd_repos/qpyr_dendro/', sep='')

# sj 
sj <- read.rwl(fname=paste0(di, '/data/SNA_sanjuan.rwl'), format="tucson")
```

```{r}
compete <- read.csv(file=paste0(di, '/data_raw/dendro_competence.csv'), header=TRUE, sep=',')


compete <- compete %>% 
  mutate(dn = (perim_mm/1000) /pi) 

dd <- compete %>% 
  filter(sp=='Focal') %>% 
  filter(loc=='SJ') %>% 
  filter(id_core!='Fresno')
```


```{r}

# Function to compute BAI 

# rwl_file
myrwl <- sj

# Extract rwl serie 
myrwl_i <- myrwl[[1]]

# Remove NA 
myrwl_io <- na.omit(myrwl_i)

bai <- (pi/4)*(dbh^2 - ((d - 2*w)^2)) 



sjD <- sj[["SNA0101"]]
dbh <- 1170 / pi 


baiD <- bai.out(sj[["SNA0101"]], dbh)

```

